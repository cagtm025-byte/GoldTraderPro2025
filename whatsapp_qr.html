<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>WhatsApp QR Code Generator ‚Äî GoldTrader Pro</title>
<link rel="stylesheet" href="style.css">
<meta name="color-scheme" content="dark light">
<script>
try {
  const pref = localStorage.getItem("themePreference") || "system";
  if (pref === "system") {
    const sysDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    document.documentElement.dataset.theme = sysDark ? "dark" : "light";
  } else {
    document.documentElement.dataset.theme = pref;
  }
} catch(e) { document.documentElement.dataset.theme = "dark"; }
</script>
</head>
<body>
<header>
  <div style="display:flex;align-items:center">
    <div class="brand">
      <div class="logo">GT</div>
      <div>
        <div style="font-weight:700">GoldTrader Pro</div>
        <div class="small">Invoicing & Inventory ‚Äî simple, secure, professional</div>
      </div>
    </div>
    <div class="role-group" style="margin-left:20px">
      <label for="roleSelect" class="small">Access</label>
      <select id="roleSelect" aria-label="Select access role">
        <option value="tenant">Tenant</option>
        <option value="admin">Admin</option>
      </select>
    </div>
  </div>

  <div class="nav">
    <a href="index.html"><button class="btn btn-ghost">Home</button></a>
    <a href="pricing.html"><button class="btn btn-ghost">Pricing</button></a>
    <a href="whatsapp_qr.html"><button class="btn btn-ghost">QR Generator</button></a>
    <a href="contact.html"><button class="btn btn-ghost">Contact</button></a>
  </div>

  <div class="theme-controls">
    <button id="themeBtn" class="btn btn-ghost" title="Toggle theme">üåô</button>
  </div>

  <!-- ‚úÖ Hamburger menu on right -->
  <button class="hamburger" id="hamburgerBtn" aria-label="Toggle menu">
    <span class="bar"></span>
  </button>
</header>

<main class="container">

  <!-- ‚úÖ Back to home button -->
  <div style="display:flex;justify-content:flex-end;margin-bottom:10px;">
    <a href="index.html"><button class="btn btn-ghost">‚Üê Back to Home</button></a>
  </div>

  <section id="whatsapp-qr" class="section" style="margin-top:0;padding:18px;border-radius:14px;">

    <h2 style="margin-top:0">WhatsApp QR Code Generator</h2>
    <p class="small muted">Generate a WhatsApp QR code that lets people message you instantly ‚Äî no app setup required.</p>
    <div style="display:flex;gap:12px;flex-wrap:wrap;align-items:flex-start;margin-top:12px">
      <div style="flex:1 1 320px;min-width:260px;">
        <div class="card-surface" style="padding:12px;border-radius:10px;border:1px solid var(--border)">
          <label class="small" for="waPhone">Phone number (international, no +)</label>
          <input id="waPhone" placeholder="919812345678" style="width:100%;padding:8px;margin-top:6px;margin-bottom:10px" />

         <label class="small" for="waMessage">Prefilled message</label>
<textarea
  id="waMessage"
  rows="4"
  style="width:100%;padding:8px;margin-top:6px;margin-bottom:10px"
  readonly
>Hello! I would like to get a copy of my jewellery invoice. Please share it with me. Thank you.</textarea>



          <div style="display:flex;gap:8px;align-items:center;margin-bottom:10px">
            <label class="small" style="margin:0">Size</label>
            <input id="waSize" type="range" min="120" max="800" value="300" style="flex:1"/>
            <span id="waSizeLabel" class="small" style="min-width:48px;text-align:right">300</span>
          </div>

          <div style="display:flex;gap:8px">
            <button id="waGenerate" class="btn btn-primary">Generate QR</button>
            <button id="waClear" class="btn btn-ghost">Clear</button>
            <a id="waDownload" class="btn btn-primary" style="display:none" download="whatsapp_qr.png">Download PNG</a>
          </div>

          <div style="margin-top:10px" class="small muted">
            <div>Use numbers only, in international format (country code + number). Example: <code>919812345678</code></div>
          </div>
        </div>
      </div>

      <div style="flex:0 0 320px;min-width:220px;">
        <div class="card-surface" style="padding:12px;border-radius:10px;border:1px solid var(--border);text-align:center">
          <div style="margin-bottom:8px"><strong>Preview</strong></div>
          <canvas id="waCanvas" width="300" height="300" style="background:#fff;border:1px solid var(--border);border-radius:8px"></canvas>
          <div id="waLinkWrap" style="margin-top:8px;word-break:break-all;display:none">
            <div class="small">Link:</div>
            <a id="waLink" href="#" target="_blank"></a>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="footer">GoldTrader Pro ‚Äî hosted at goldtraderpro.in <span id="year"></span></footer>
</main>

<!-- QRious library -->
<script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>

<script>
(function(){
  const phoneInput=document.getElementById('waPhone'),
        msgInput=document.getElementById('waMessage'),
        sizeRange=document.getElementById('waSize'),
        sizeLabel=document.getElementById('waSizeLabel'),
        generateBtn=document.getElementById('waGenerate'),
        clearBtn=document.getElementById('waClear'),
        downloadLink=document.getElementById('waDownload'),
        canvas=document.getElementById('waCanvas'),
        waLink=document.getElementById('waLink'),
        waLinkWrap=document.getElementById('waLinkWrap');

  let qr=new QRious({element:canvas,value:'',size:Number(sizeRange.value),level:'M'});
  function isValidPhone(p){return /^\d{8,15}$/.test(p.trim());}
  function buildWaLink(phone,msg){const base='https://wa.me/';return msg.trim()?base+phone+'?text='+encodeURIComponent(msg):base+phone;}
  function updateSizeLabel(){sizeLabel.textContent=sizeRange.value;qr.size=Number(sizeRange.value);canvas.width=qr.size;canvas.height=qr.size;if(qr.value)qr.value=qr.value;}
  sizeRange.addEventListener('input',updateSizeLabel);
  generateBtn.addEventListener('click',()=>{
    const p = phoneInput.value.trim(), m = msgInput.value.trim();
if (!isValidPhone(p)) { alert('Invalid phone number.'); return; }
if (!m) { alert('Please enter a message before generating QR.'); return; }

    const url=buildWaLink(p,m);qr.value=url;waLink.href=url;waLink.textContent=url;waLinkWrap.style.display='block';
    setTimeout(()=>{const dataURL=canvas.toDataURL('image/png');downloadLink.href=dataURL;downloadLink.style.display='inline-block';},50);
  });
  clearBtn.addEventListener('click',()=>{qr.value='';waLinkWrap.style.display='none';downloadLink.style.display='none';canvas.getContext('2d').clearRect(0,0,canvas.width,canvas.height);phoneInput.value='';msgInput.value='';});
  phoneInput.addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault();generateBtn.click();}});
  updateSizeLabel();
})();
</script>

<script>
(function () {
  // safe theme helper ‚Äî works whether or not #themePref exists
  const prefSel = document.getElementById("themePref");
  const btn = document.getElementById("themeBtn");

  function applyTheme(theme) {
    document.documentElement.dataset.theme = theme;
    if (btn) btn.textContent = theme === "dark" ? "üåô" : "‚òÄÔ∏è";
  }

  function resolveAndApply(pref) {
    if (pref === "system") {
      const mq = window.matchMedia('(prefers-color-scheme: dark)');
      applyTheme(mq.matches ? "dark" : "light");
    } else {
      applyTheme(pref);
    }
  }

  // read stored preference safely
  const storedPref = (function () {
    try { return localStorage.getItem("themePreference") || "system"; }
    catch (e) { return "system"; }
  })();

  // initial apply
  resolveAndApply(storedPref);

  // if the select exists, wire it up; otherwise skip safely
  if (prefSel) {
    prefSel.value = storedPref;
    prefSel.addEventListener("change", function () {
      const v = prefSel.value;
      try { localStorage.setItem("themePreference", v); } catch (e) {}
      resolveAndApply(v);
    });
  }

  // wire toggle button if present
  if (btn) {
    btn.addEventListener("click", function () {
      const current = document.documentElement.dataset.theme === "dark" ? "dark" : "light";
      const next = current === "dark" ? "light" : "dark";
      try { localStorage.setItem("themePreference", next); } catch (e) {}
      if (prefSel) prefSel.value = next;
      resolveAndApply(next);
    });
  }

  // respond to system changes only if preference==system
  const mq = window.matchMedia('(prefers-color-scheme: dark)');
  mq.addEventListener && mq.addEventListener('change', function () {
    try {
      if ((localStorage.getItem("themePreference") || "system") === "system") {
        resolveAndApply("system");
      }
    } catch (e) { /* ignore */ }
  });
})();
</script>


<script>
document.addEventListener("DOMContentLoaded",()=>{document.getElementById("year").textContent=new Date().getFullYear();});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  try {
    const hamburger = document.getElementById('hamburgerBtn');
    const nav = document.querySelector('.nav');

    if (!hamburger || !nav) {
      // nothing to do on pages without the expected header structure
      return;
    }

    // ensure aria attributes for accessibility
    hamburger.setAttribute('aria-expanded', 'false');
    hamburger.setAttribute('aria-controls', 'main-nav');

    // give nav an id if missing (helps aria-controls)
    if (!nav.id) nav.id = 'main-nav';

    // toggle function
    const toggleNav = () => {
      const isOpen = nav.classList.toggle('open');
      hamburger.setAttribute('aria-expanded', String(!!isOpen));
      // trap focus could be added later ‚Äî basic behavior for now
    };

    // attach click
    hamburger.addEventListener('click', function (ev) {
      ev.stopPropagation(); // don't let body click close immediately
      toggleNav();
    });

    // close nav when clicking outside (mobile)
    document.addEventListener('click', function (ev) {
      if (!nav.classList.contains('open')) return;
      // if click is inside nav or on hamburger, ignore
      if (nav.contains(ev.target) || hamburger.contains(ev.target)) return;
      nav.classList.remove('open');
      hamburger.setAttribute('aria-expanded', 'false');
    });

    // close with Escape key
    document.addEventListener('keydown', function (ev) {
      if (ev.key === 'Escape' && nav.classList.contains('open')) {
        nav.classList.remove('open');
        hamburger.setAttribute('aria-expanded', 'false');
        hamburger.focus();
      }
    });

    // Optional: auto-hide nav when window resizes to desktop
    window.addEventListener('resize', function () {
      if (window.innerWidth > 700 && nav.classList.contains('open')) {
        nav.classList.remove('open');
        hamburger.setAttribute('aria-expanded', 'false');
      }
    });
  } catch (err) {
    // log error cleanly ‚Äî won't break other scripts
    console.error('Hamburger init error:', err);
  }
});
</script>
</body>
</html>
